!function(p){jQuery.fn.extend({elastic:function(){var i=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){if("textarea"!==this.type)return!1;var o=jQuery(this),n=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"}),h=parseInt(o.css("line-height"),10)||parseInt(o.css("font-size"),"10"),a=parseInt(o.css("height"),10)||3*h,d=parseInt(o.css("max-height"),10)||Number.MAX_VALUE;d<0&&(d=Number.MAX_VALUE),n.appendTo(o.parent());for(var t=i.length;t--;)n.css(i[t].toString(),o.css(i[t].toString()));function e(){var t=Math.floor(parseInt(o.width(),10));n.width()!==t&&(n.css({width:t+"px"}),r(!0))}function s(t,e){var r=Math.floor(parseInt(t,10));o.height()!==r&&o.css({height:r+"px",overflow:e})}function r(t){var e=o.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),r=n.html().replace(/<br>/gi,"<br />");if((t||e+"&nbsp;"!==r)&&(n.html(e+"&nbsp;"),3<Math.abs(n.height()+h-o.height()))){var i=n.height()+h;d<=i?s(d,"auto"):s(i<=a?a:i,"hidden")}}o.css({overflow:"hidden"}),o.bind("keyup change cut paste",function(){r()}),p(window).bind("resize",e),o.bind("resize",e),o.bind("update",r),o.bind("blur",function(){n.height()<d&&(n.height()>a?o.height(n.height()):o.height(a-h))}),o.bind("input paste",function(t){setTimeout(r,250)}),r()})}})}(jQuery);
